fill = ref_chr, group = paste0("s",i))
}
synteny = rbind(synteny,df)
}
#This prints plot
ggplot(size = 0.2, font = 10, data = data) +
geom_rect(data=ref_sizes, mapping=aes(xmin=xstart, xmax=xend, ymin=2, ymax=3),
fill="white", color="black", alpha = 0.85, size = 0.2 ) +
geom_rect(data=tar_sizes, mapping=aes(xmin=xstart, xmax=xend, ymin=0, ymax=1),
fill="white", color="black", alpha = 0.85, size = 0.2 ) +
geom_polygon(data = synteny, alpha = .5, aes(x = x, y = y, group = group, fill = fill)) +
scale_fill_manual(values = c("1" = "#BFD73B", "2" = "#39ACE2", "3" = "#F16E8A",
"4" = "#2DB995", "5" = "#855823", "6" = "#A085BD",
"7" = "#2EB560", "8" = "#D79128", "9" = "#FDBB63",
"10" = "#AFDFE5", "11" = "#BF1E2D", "12" = "purple4",
"13"= "#B59F31", "14" = "#F68B1F", "15" = "#EF374B",
"16" = "#D376FF", "17" = "#009445", "18" = "#CE4699",
"19" = "#7C9ACD", "20" = "#84C441", "21" = "#404F23",
"22" = "#607F4B", "23" = "#EBB4A9", "24" = "#F6EB83",
"25" = "#915F6D", "26" = "#602F92", "27" = "#81CEC6",
"28" = "#F8DA04", "29" = "peachpuff2", "30" = "gray85", "33" = "peachpuff3",
"W" = "#9590FF", "Z" = "#666666", "Y" = "#9590FF", "X" = "#666666",
"LGE22" = "grey", "LGE64" = "gray64",
"1A" = "pink", "1B" = "dark blue", "4A" = "light green",
"Gap" = "white"))
#This prints plot
ggplot(size = 0.2, font = 10, data = data) +
geom_rect(data=ref_sizes, mapping=aes(xmin=xstart, xmax=xend, ymin=2, ymax=3),
fill="white", color="black", alpha = 0.85, size = 0.2 ) +
geom_rect(data=tar_sizes, mapping=aes(xmin=xstart, xmax=xend, ymin=0, ymax=1),
fill="white", color="black", alpha = 0.85, size = 0.2 ) +
geom_polygon(data = synteny, alpha = .5, aes(x = x, y = y, group = group, fill = fill)) +
scale_fill_manual(values = c("1" = "#BFD73B", "2" = "#39ACE2", "3" = "#F16E8A",
"4" = "#2DB995", "5" = "#855823", "6" = "#A085BD",
"7" = "#2EB560", "8" = "#D79128", "9" = "#FDBB63",
"10" = "#AFDFE5", "11" = "#BF1E2D", "12" = "purple4",
"13"= "#B59F31", "14" = "#F68B1F", "15" = "#EF374B",
"16" = "#D376FF", "17" = "#009445", "18" = "#CE4699",
"19" = "#7C9ACD", "20" = "#84C441", "21" = "#404F23",
"22" = "#607F4B", "23" = "#EBB4A9", "24" = "#F6EB83",
"25" = "#915F6D", "26" = "#602F92", "27" = "#81CEC6",
"28" = "#F8DA04", "29" = "peachpuff2", "30" = "gray85", "33" = "peachpuff3",
"W" = "#9590FF", "Z" = "#666666", "Y" = "#9590FF", "X" = "#666666",
"LGE22" = "grey", "LGE64" = "gray64",
"1A" = "pink", "1B" = "dark blue", "4A" = "light green",
"Gap" = "white"))
ggplot(size = 0.2, font = 10, data = data) +
geom_rect(data=ref_sizes, mapping=aes(xmin=xstart, xmax=xend, ymin=2, ymax=3),
fill="white", color="black", alpha = 0.85, size = 0.2 )
ggplot(size = 0.2, font = 10, data = data) +
geom_rect(data=ref_sizes, mapping=aes(xmin=xstart, xmax=xend, ymin=2, ymax=3),
fill="white", color="black", alpha = 0.85, size = 0.2 ) +
geom_rect(data=tar_sizes, mapping=aes(xmin=xstart, xmax=xend, ymin=0, ymax=1),
fill="white", color="black", alpha = 0.85, size = 0.2 ) +
geom_polygon(data = synteny, alpha = .5, aes(x = x, y = y, group = group, fill = fill))
ggplot(size = 0.2, font = 10, data = data) +
geom_rect(data=ref_sizes, mapping=aes(xmin=xstart, xmax=xend, ymin=2, ymax=3),
fill="white", color="black", alpha = 0.85, size = 0.2 ) +
geom_rect(data=tar_sizes, mapping=aes(xmin=xstart, xmax=xend, ymin=0, ymax=1),
fill="white", color="black", alpha = 0.85, size = 0.2 ) +
geom_polygon(data = synteny, alpha = .5, aes(x = x, y = y, group = group, fill = fill)) +
scale_fill_manual(values = c("1" = "#BFD73B", "2" = "#39ACE2", "3" = "#F16E8A",
"4" = "#2DB995", "5" = "#855823", "6" = "#A085BD",
"7" = "#2EB560", "8" = "#D79128", "9" = "#FDBB63",
"10" = "#AFDFE5", "11" = "#BF1E2D", "12" = "purple4",
"13"= "#B59F31", "14" = "#F68B1F", "15" = "#EF374B",
"16" = "#D376FF", "17" = "#009445", "18" = "#CE4699",
"19" = "#7C9ACD", "20" = "#84C441", "21" = "#404F23",
"22" = "#607F4B", "23" = "#EBB4A9", "24" = "#F6EB83",
"25" = "#915F6D", "26" = "#602F92", "27" = "#81CEC6",
"28" = "#F8DA04", "29" = "peachpuff2", "30" = "gray85", "33" = "peachpuff3",
"W" = "#9590FF", "Z" = "#666666", "Y" = "#9590FF", "X" = "#666666",
"LGE22" = "grey", "LGE64" = "gray64",
"1A" = "pink", "1B" = "dark blue", "4A" = "light green",
"Gap" = "white"))
#making sure chr columns are factors
tar_sizes$tarchr<-as.factor(tar_sizes$tarchr)
ref_sizes$refchr<-as.factor(ref_sizes$refchr)
ggplot(size = 0.2, font = 10, data = data) +
geom_rect(data=ref_sizes, mapping=aes(xmin=xstart, xmax=xend, ymin=2, ymax=3),
fill="white", color="black", alpha = 0.85, size = 0.2 ) +
geom_rect(data=tar_sizes, mapping=aes(xmin=xstart, xmax=xend, ymin=0, ymax=1),
fill="white", color="black", alpha = 0.85, size = 0.2 ) +
geom_polygon(data = synteny, alpha = .5, aes(x = x, y = y, group = group, fill = fill)) +
scale_fill_manual(values = c("1" = "#BFD73B", "2" = "#39ACE2", "3" = "#F16E8A",
"4" = "#2DB995", "5" = "#855823", "6" = "#A085BD",
"7" = "#2EB560", "8" = "#D79128", "9" = "#FDBB63",
"10" = "#AFDFE5", "11" = "#BF1E2D", "12" = "purple4",
"13"= "#B59F31", "14" = "#F68B1F", "15" = "#EF374B",
"16" = "#D376FF", "17" = "#009445", "18" = "#CE4699",
"19" = "#7C9ACD", "20" = "#84C441", "21" = "#404F23",
"22" = "#607F4B", "23" = "#EBB4A9", "24" = "#F6EB83",
"25" = "#915F6D", "26" = "#602F92", "27" = "#81CEC6",
"28" = "#F8DA04", "29" = "peachpuff2", "30" = "gray85", "33" = "peachpuff3",
"W" = "#9590FF", "Z" = "#666666", "Y" = "#9590FF", "X" = "#666666",
"LGE22" = "grey", "LGE64" = "gray64",
"1A" = "pink", "1B" = "dark blue", "4A" = "light green",
"Gap" = "white"))
ggplot(size = 0.2, font = 10, data = data) +
geom_rect(data=ref_sizes, mapping=aes(xmin=xstart, xmax=xend, ymin=2, ymax=3),
fill="white", color="black", alpha = 0.85, size = 0.2 ) +
geom_rect(data=tar_sizes, mapping=aes(xmin=xstart, xmax=xend, ymin=0, ymax=1),
fill="white", color="black", alpha = 0.85, size = 0.2 ) +
geom_polygon(data = synteny, alpha = .5, aes(x = x, y = y, group = group, fill = fill))
ggplot2::ggplot(size = 0.2, font = 10, data = data) +
ggplot2::geom_rect(data=ref_sizes, mapping=ggplot2::aes(xmin=xstart, xmax=xend, ymin=2, ymax=2.10, fill=refchr),
color="black", alpha = 0.85, size = 0.2 ) +
ggplot2::geom_text(data=ref_sizes,ggplot2::aes(x=(xstart+xend)/2,y=2.15,label=refchr),size=2,angle=45) +
ggplot2::geom_text(mapping=ggplot2::aes(x=2,y=2.3, label=tarName),size=3,hjust = 1) +
ggplot2::geom_rect(data=tar_sizes, mapping=ggplot2::aes(xmin=xstart, xmax=xend, ymin=0, ymax=0.10),fill="grey85",
color="black", alpha = 0.85, size = 0.2 ) +
ggplot2::geom_text(data=tar_sizes,ggplot2::aes(x=(xstart+xend)/2,y=-0.05,label=tarchr),size=2,angle=45) +
ggplot2::geom_text(mapping=ggplot2::aes(x=2,y=-0.20, label=refName),size=3,hjust = 1) +
ggplot2::geom_polygon(data = synteny, alpha = .5, ggplot2::aes(x = x, y = y, group = group, fill = fill))
tarName<-"test"
refName<-"aa"
ggplot2::ggplot(size = 0.2, font = 10, data = data) +
ggplot2::geom_rect(data=ref_sizes, mapping=ggplot2::aes(xmin=xstart, xmax=xend, ymin=2, ymax=2.10, fill=refchr),
color="black", alpha = 0.85, size = 0.2 ) +
ggplot2::geom_text(data=ref_sizes,ggplot2::aes(x=(xstart+xend)/2,y=2.15,label=refchr),size=2,angle=45) +
ggplot2::geom_text(mapping=ggplot2::aes(x=2,y=2.3, label=tarName),size=3,hjust = 1) +
ggplot2::geom_rect(data=tar_sizes, mapping=ggplot2::aes(xmin=xstart, xmax=xend, ymin=0, ymax=0.10),fill="grey85",
color="black", alpha = 0.85, size = 0.2 ) +
ggplot2::geom_text(data=tar_sizes,ggplot2::aes(x=(xstart+xend)/2,y=-0.05,label=tarchr),size=2,angle=45) +
ggplot2::geom_text(mapping=ggplot2::aes(x=2,y=-0.20, label=refName),size=3,hjust = 1) +
ggplot2::geom_polygon(data = synteny, alpha = .5, ggplot2::aes(x = x, y = y, group = group, fill = fill))
ggplot2::ggplot(size = 0.2, font = 10, data = data) +
ggplot2::geom_rect(data=ref_sizes, mapping=ggplot2::aes(xmin=xstart, xmax=xend, ymin=2, ymax=2.10, fill=refchr),
color="black", alpha = 0.85, size = 0.2 ) +
ggplot2::geom_text(data=ref_sizes,ggplot2::aes(x=(xstart+xend)/2,y=2.15,label=refchr),size=2,angle=45)
ggplot2::ggplot(size = 0.2, font = 10, data = data) +
ggplot2::geom_rect(data=ref_sizes, mapping=ggplot2::aes(xmin=xstart, xmax=xend, ymin=2, ymax=2.10, fill=refchr),
color="black", alpha = 0.85, size = 0.2 ) +
ggplot2::geom_text(data=ref_sizes,ggplot2::aes(x=(xstart+xend)/2,y=2.15,label=refchr),size=2,angle=45) +
ggplot2::geom_text(mapping=ggplot2::aes(x=2,y=2.3, label=tarName),size=3,hjust = 1)
ggplot2::ggplot(size = 0.2, font = 10, data = data) +
ggplot2::geom_rect(data=ref_sizes, mapping=ggplot2::aes(xmin=xstart, xmax=xend, ymin=2, ymax=2.10, fill=refchr),
color="black", alpha = 0.85, size = 0.2 ) +
ggplot2::geom_text(data=ref_sizes,ggplot2::aes(x=(xstart+xend)/2,y=2.15,label=refchr),size=2,angle=45) +
ggplot2::geom_text(mapping=ggplot2::aes(x=2,y=2.3, label=tarName),size=3,hjust = 1) +
ggplot2::geom_rect(data=tar_sizes, mapping=ggplot2::aes(xmin=xstart, xmax=xend, ymin=0, ymax=0.10),fill="grey85",
color="black", alpha = 0.85, size = 0.2 )
ggplot2::ggplot(size = 0.2, font = 10, data = data) +
ggplot2::geom_rect(data=ref_sizes, mapping=ggplot2::aes(xmin=xstart, xmax=xend, ymin=2, ymax=2.10, fill=refchr),
color="black", alpha = 0.85, size = 0.2 ) +
ggplot2::geom_text(data=ref_sizes,ggplot2::aes(x=(xstart+xend)/2,y=2.15,label=refchr),size=2,angle=45) +
ggplot2::geom_text(mapping=ggplot2::aes(x=2,y=2.3, label=tarName),size=3,hjust = 1) +
ggplot2::geom_rect(data=tar_sizes, mapping=ggplot2::aes(xmin=xstart, xmax=xend, ymin=0, ymax=0.10),fill="grey85",
color="black", alpha = 0.85, size = 0.2 ) +
ggplot2::geom_text(data=tar_sizes,ggplot2::aes(x=(xstart+xend)/2,y=-0.05,label=tarchr),size=2,angle=45)
ggplot2::ggplot(size = 0.2, font = 10, data = data) +
ggplot2::geom_rect(data=ref_sizes, mapping=ggplot2::aes(xmin=xstart, xmax=xend, ymin=2, ymax=2.10, fill=refchr),
color="black", alpha = 0.85, size = 0.2 ) +
ggplot2::geom_text(data=ref_sizes,ggplot2::aes(x=(xstart+xend)/2,y=2.15,label=refchr),size=2,angle=45) +
ggplot2::geom_text(mapping=ggplot2::aes(x=2,y=2.3, label=tarName),size=3,hjust = 1) +
ggplot2::geom_rect(data=tar_sizes, mapping=ggplot2::aes(xmin=xstart, xmax=xend, ymin=0, ymax=0.10),fill="grey85",
color="black", alpha = 0.85, size = 0.2 ) +
ggplot2::geom_text(data=tar_sizes,ggplot2::aes(x=(xstart+xend)/2,y=-0.05,label=tarchr),size=2,angle=45) +
ggplot2::geom_text(mapping=ggplot2::aes(x=2,y=-0.20, label=refName),size=3,hjust = 1)
ggplot2::ggplot(size = 0.2, font = 10, data = data) +
ggplot2::geom_rect(data=ref_sizes, mapping=ggplot2::aes(xmin=xstart, xmax=xend, ymin=2, ymax=2.10, fill=refchr),
color="black", alpha = 0.85, size = 0.2 ) +
ggplot2::geom_text(data=ref_sizes,ggplot2::aes(x=(xstart+xend)/2,y=2.15,label=refchr),size=2,angle=45) +
ggplot2::geom_text(mapping=ggplot2::aes(x=2,y=2.3, label=tarName),size=3,hjust = 1) +
ggplot2::geom_rect(data=tar_sizes, mapping=ggplot2::aes(xmin=xstart, xmax=xend, ymin=0, ymax=0.10),fill="grey85",
color="black", alpha = 0.85, size = 0.2 ) +
ggplot2::geom_text(data=tar_sizes,ggplot2::aes(x=(xstart+xend)/2,y=-0.05,label=tarchr),size=2,angle=45) +
ggplot2::geom_text(mapping=ggplot2::aes(x=2,y=-0.20, label=refName),size=3,hjust = 1) +
ggplot2::geom_polygon(data = synteny, alpha = .5, ggplot2::aes(x = x, y = y, group = group, fill = fill))
head(synteny)
synteny$fill<-as.factor(synteny$fill)
#pdf(paste0("test1",".pdf"),width=20, height =5, pointsize = 10)
#This prints plot
ggplot2::ggplot(size = 0.2, font = 10, data = data) +
ggplot2::geom_rect(data=ref_sizes, mapping=ggplot2::aes(xmin=xstart, xmax=xend, ymin=2, ymax=2.10, fill=refchr),
color="black", alpha = 0.85, size = 0.2 ) +
ggplot2::geom_text(data=ref_sizes,ggplot2::aes(x=(xstart+xend)/2,y=2.15,label=refchr),size=2,angle=45) +
ggplot2::geom_text(mapping=ggplot2::aes(x=2,y=2.3, label=tarName),size=3,hjust = 1) +
ggplot2::geom_rect(data=tar_sizes, mapping=ggplot2::aes(xmin=xstart, xmax=xend, ymin=0, ymax=0.10),fill="grey85",
color="black", alpha = 0.85, size = 0.2 ) +
ggplot2::geom_text(data=tar_sizes,ggplot2::aes(x=(xstart+xend)/2,y=-0.05,label=tarchr),size=2,angle=45) +
ggplot2::geom_text(mapping=ggplot2::aes(x=2,y=-0.20, label=refName),size=3,hjust = 1) +
ggplot2::geom_polygon(data = synteny, alpha = .5, ggplot2::aes(x = x, y = y, group = group, fill = fill)) +
ggplot2::scale_fill_manual(values = c("1" = "#BFD73B", "2" = "#39ACE2", "3" = "#F16E8A",
"4" = "#2DB995", "5" = "#855823", "6" = "#A085BD",
"7" = "#2EB560", "8" = "#D79128", "9" = "#FDBB63",
"10" = "#AFDFE5", "11" = "#BF1E2D", "12" = "purple4",
"13"= "#B59F31", "14" = "#F68B1F", "15" = "#EF374B",
"16" = "#D376FF", "17" = "#009445", "18" = "#CE4699",
"19" = "#7C9ACD", "20" = "#84C441", "21" = "#404F23",
"22" = "#607F4B", "23" = "#EBB4A9", "24" = "#F6EB83",
"25" = "#915F6D", "26" = "#602F92", "27" = "#81CEC6",
"28" = "#F8DA04", "29" = "peachpuff2", "30" = "gray85", "33" = "peachpuff3",
"W" = "#9590FF", "Z" = "#666666", "Y" = "#9590FF", "X" = "#666666",
"LGE22" = "grey", "LGE64" = "gray64",
"1A" = "pink", "1B" = "dark blue", "4A" = "light green",
"Gap" = "white", "LG2" = "black", "LG5" = "#CC99CC")) +
ggplot2::theme(panel.background = ggplot2::element_blank(),
strip.background = ggplot2::element_blank(),
axis.title.y = ggplot2::element_blank(),
axis.title.x = ggplot2::element_blank(),
axis.text.x = ggplot2::element_blank(),
axis.text.y = ggplot2::element_blank(),
axis.ticks.x=ggplot2::element_blank(),
axis.ticks.y=ggplot2::element_blank(),
legend.position="none")
draw.pairwise <- function(infile,output,refSizes,tarSizes,refName,tarName) {
dataTMP<- read.delim(infile, header=FALSE)
data<-dataTMP[,c(4,5,6,1,2,3,7)]
ref_sizes <-read.delim(refSizes, header=FALSE) #to be consistent with naming in EH
tar_sizes <-read.delim(tarSizes, header=FALSE)
colnames(data) = c("tarchr", "tarstart", "tarend", "refchr", "refstart", "refend", "dir")
colnames(ref_sizes) = c("refchr", "size")
colnames(tar_sizes) = c("tarchr", "size")
#This adds gap in between reference chromosomes and convert to "linear" genome
for (i in c(1:nrow(ref_sizes))){
#print(i)
if (i == 1){
total_start = 1
total_end = ref_sizes[i, "size"]
} else {
total_start = total_end + 6000000
total_end = total_start + ref_sizes[i, "size"]
}
ref_sizes[i,"xstart"] = total_start
ref_sizes[i, "xend"] = total_end
}
#This adds gap in between target chromosomes
for (i in c(1:nrow(tar_sizes))){
#print(i)
if (i == 1){
total_start = 1
total_end = tar_sizes[i, "size"]
} else {
total_start = total_end + 6000000
total_end = total_start + tar_sizes[i, "size"]
}
tar_sizes[i,"xstart"] = total_start
tar_sizes[i, "xend"] = total_end
}
#This converts coordinates to linear genome and creates synteny polygon coordinates
synteny = data.frame()
for (i in c(1:nrow(data))){
tar_chr = data[i,"tarchr"]
ref_chr = data[i,"refchr"]
dir = data[i, "dir"]
tar_add = tar_sizes[as.character(tar_sizes$tarchr)==as.character(tar_chr),]$xstart
ref_add = ref_sizes[as.character(ref_sizes$refchr)==as.character(ref_chr),]$xstart
tar_y = 0.1
ref_y = 2
tar_xstart = data[i,"tarstart"] + tar_add
tar_xend = data[i,"tarend"] + tar_add
ref_xstart = data[i,"refstart"] + ref_add
ref_xend = data[i,"refend"] + ref_add
inverted = grepl("-", dir, fixed = TRUE)
if(inverted == TRUE){
df = data.frame(x = c(tar_xstart, tar_xend, ref_xstart, ref_xend), y = c(tar_y, tar_y, ref_y, ref_y),
fill = ref_chr, group = paste0("s",i))
} else {
df = data.frame(x = c(tar_xstart, ref_xstart, ref_xend,  tar_xend), y = c(tar_y, ref_y, ref_y, tar_y),
fill = ref_chr, group = paste0("s",i))
}
synteny = rbind(synteny,df)
}
#making sure chr columns are factors
tar_sizes$tarchr<-as.factor(tar_sizes$tarchr)
ref_sizes$refchr<-as.factor(ref_sizes$refchr)
synteny$fill<-as.factor(synteny$fill)
#pdf(paste0("test1",".pdf"),width=20, height =5, pointsize = 10)
#This prints plot
ggplot2::ggplot(size = 0.2, font = 10, data = data) +
ggplot2::geom_rect(data=ref_sizes, mapping=ggplot2::aes(xmin=xstart, xmax=xend, ymin=2, ymax=2.10, fill=refchr),
color="black", alpha = 0.85, size = 0.2 ) +
ggplot2::geom_text(data=ref_sizes,ggplot2::aes(x=(xstart+xend)/2,y=2.15,label=refchr),size=2,angle=45) +
ggplot2::geom_text(mapping=ggplot2::aes(x=2,y=2.3, label=tarName),size=3,hjust = 1) +
ggplot2::geom_rect(data=tar_sizes, mapping=ggplot2::aes(xmin=xstart, xmax=xend, ymin=0, ymax=0.10),fill="grey85",
color="black", alpha = 0.85, size = 0.2 ) +
ggplot2::geom_text(data=tar_sizes,ggplot2::aes(x=(xstart+xend)/2,y=-0.05,label=tarchr),size=2,angle=45) +
ggplot2::geom_text(mapping=ggplot2::aes(x=2,y=-0.20, label=refName),size=3,hjust = 1) +
ggplot2::geom_polygon(data = synteny, alpha = .5, ggplot2::aes(x = x, y = y, group = group, fill = fill)) +
ggplot2::scale_fill_manual(values = c("1" = "#BFD73B", "2" = "#39ACE2", "3" = "#F16E8A",
"4" = "#2DB995", "5" = "#855823", "6" = "#A085BD",
"7" = "#2EB560", "8" = "#D79128", "9" = "#FDBB63",
"10" = "#AFDFE5", "11" = "#BF1E2D", "12" = "purple4",
"13"= "#B59F31", "14" = "#F68B1F", "15" = "#EF374B",
"16" = "#D376FF", "17" = "#009445", "18" = "#CE4699",
"19" = "#7C9ACD", "20" = "#84C441", "21" = "#404F23",
"22" = "#607F4B", "23" = "#EBB4A9", "24" = "#F6EB83",
"25" = "#915F6D", "26" = "#602F92", "27" = "#81CEC6",
"28" = "#F8DA04", "29" = "peachpuff2", "30" = "gray85", "33" = "peachpuff3",
"W" = "#9590FF", "Z" = "#666666", "Y" = "#9590FF", "X" = "#666666",
"LGE22" = "grey", "LGE64" = "gray64",
"1A" = "pink", "1B" = "dark blue", "4A" = "light green",
"Gap" = "white", "LG2" = "black", "LG5" = "#CC99CC")) +
ggplot2::theme(panel.background = ggplot2::element_blank(),
strip.background = ggplot2::element_blank(),
axis.title.y = ggplot2::element_blank(),
axis.title.x = ggplot2::element_blank(),
axis.text.x = ggplot2::element_blank(),
axis.text.y = ggplot2::element_blank(),
axis.ticks.x=ggplot2::element_blank(),
axis.ticks.y=ggplot2::element_blank(),
legend.position="none")
#dev.off()
ggsave(paste0(output,".pdf"),width=20, height =5, pointsize = 10)
}
draw.pairwise("testEre.bed","testingAnc","APCF_sizes.txt","Eresizes.txt","Anc","ere")
draw.pairwise <- function(infile,output,refSizes,tarSizes,refName,tarName) {
dataTMP<- read.delim(infile, header=FALSE)
data<-dataTMP[,c(4,5,6,1,2,3,7)]
ref_sizes <-read.delim(refSizes, header=FALSE) #to be consistent with naming in EH
tar_sizes <-read.delim(tarSizes, header=FALSE)
colnames(data) = c("tarchr", "tarstart", "tarend", "refchr", "refstart", "refend", "dir")
colnames(ref_sizes) = c("refchr", "size")
colnames(tar_sizes) = c("tarchr", "size")
#This adds gap in between reference chromosomes and convert to "linear" genome
for (i in c(1:nrow(ref_sizes))){
#print(i)
if (i == 1){
total_start = 1
total_end = ref_sizes[i, "size"]
} else {
total_start = total_end + 6000000
total_end = total_start + ref_sizes[i, "size"]
}
ref_sizes[i,"xstart"] = total_start
ref_sizes[i, "xend"] = total_end
}
#This adds gap in between target chromosomes
for (i in c(1:nrow(tar_sizes))){
#print(i)
if (i == 1){
total_start = 1
total_end = tar_sizes[i, "size"]
} else {
total_start = total_end + 6000000
total_end = total_start + tar_sizes[i, "size"]
}
tar_sizes[i,"xstart"] = total_start
tar_sizes[i, "xend"] = total_end
}
#This converts coordinates to linear genome and creates synteny polygon coordinates
synteny = data.frame()
for (i in c(1:nrow(data))){
tar_chr = data[i,"tarchr"]
ref_chr = data[i,"refchr"]
dir = data[i, "dir"]
tar_add = tar_sizes[as.character(tar_sizes$tarchr)==as.character(tar_chr),]$xstart
ref_add = ref_sizes[as.character(ref_sizes$refchr)==as.character(ref_chr),]$xstart
tar_y = 0.1
ref_y = 2
tar_xstart = data[i,"tarstart"] + tar_add
tar_xend = data[i,"tarend"] + tar_add
ref_xstart = data[i,"refstart"] + ref_add
ref_xend = data[i,"refend"] + ref_add
inverted = grepl("-", dir, fixed = TRUE)
if(inverted == TRUE){
df = data.frame(x = c(tar_xstart, tar_xend, ref_xstart, ref_xend), y = c(tar_y, tar_y, ref_y, ref_y),
fill = ref_chr, group = paste0("s",i))
} else {
df = data.frame(x = c(tar_xstart, ref_xstart, ref_xend,  tar_xend), y = c(tar_y, ref_y, ref_y, tar_y),
fill = ref_chr, group = paste0("s",i))
}
synteny = rbind(synteny,df)
}
#making sure chr columns are factors
tar_sizes$tarchr<-as.factor(tar_sizes$tarchr)
ref_sizes$refchr<-as.factor(ref_sizes$refchr)
synteny$fill<-as.factor(synteny$fill)
#pdf(paste0("test1",".pdf"),width=20, height =5, pointsize = 10)
#This prints plot
ggplot2::ggplot(size = 0.2, font = 10, data = data) +
ggplot2::geom_rect(data=ref_sizes, mapping=ggplot2::aes(xmin=xstart, xmax=xend, ymin=2, ymax=2.10, fill=refchr),
color="black", alpha = 0.85, size = 0.2 ) +
ggplot2::geom_text(data=ref_sizes,ggplot2::aes(x=(xstart+xend)/2,y=2.15,label=refchr),size=2,angle=45) +
ggplot2::geom_text(mapping=ggplot2::aes(x=2,y=2.3, label=tarName),size=3,hjust = 1) +
ggplot2::geom_rect(data=tar_sizes, mapping=ggplot2::aes(xmin=xstart, xmax=xend, ymin=0, ymax=0.10),fill="grey85",
color="black", alpha = 0.85, size = 0.2 ) +
ggplot2::geom_text(data=tar_sizes,ggplot2::aes(x=(xstart+xend)/2,y=-0.05,label=tarchr),size=2,angle=45) +
ggplot2::geom_text(mapping=ggplot2::aes(x=2,y=-0.20, label=refName),size=3,hjust = 1) +
ggplot2::geom_polygon(data = synteny, alpha = .5, ggplot2::aes(x = x, y = y, group = group, fill = fill)) +
ggplot2::scale_fill_manual(values = c("1" = "#BFD73B", "2" = "#39ACE2", "3" = "#F16E8A",
"4" = "#2DB995", "5" = "#855823", "6" = "#A085BD",
"7" = "#2EB560", "8" = "#D79128", "9" = "#FDBB63",
"10" = "#AFDFE5", "11" = "#BF1E2D", "12" = "purple4",
"13"= "#B59F31", "14" = "#F68B1F", "15" = "#EF374B",
"16" = "#D376FF", "17" = "#009445", "18" = "#CE4699",
"19" = "#7C9ACD", "20" = "#84C441", "21" = "#404F23",
"22" = "#607F4B", "23" = "#EBB4A9", "24" = "#F6EB83",
"25" = "#915F6D", "26" = "#602F92", "27" = "#81CEC6",
"28" = "#F8DA04", "29" = "peachpuff2", "30" = "gray85", "33" = "peachpuff3",
"W" = "#9590FF", "Z" = "#666666", "Y" = "#9590FF", "X" = "#666666",
"LGE22" = "grey", "LGE64" = "gray64",
"1A" = "pink", "1B" = "dark blue", "4A" = "light green",
"Gap" = "white", "LG2" = "black", "LG5" = "#CC99CC")) +
ggplot2::theme(panel.background = ggplot2::element_blank(),
strip.background = ggplot2::element_blank(),
axis.title.y = ggplot2::element_blank(),
axis.title.x = ggplot2::element_blank(),
axis.text.x = ggplot2::element_blank(),
axis.text.y = ggplot2::element_blank(),
axis.ticks.x=ggplot2::element_blank(),
axis.ticks.y=ggplot2::element_blank(),
legend.position="none")
#dev.off()
ggsave(paste0(output,".pdf"),width=20, height =5, pointsize = 10)
}
draw.pairwise("testEre.bed","testingAnc","APCF_sizes.txt","Eresizes.txt","Anc","ere")
draw.pairwise <- function(infile,output,refSizes,tarSizes,refName,tarName) {
dataTMP<- read.delim(infile, header=FALSE)
data<-dataTMP[,c(4,5,6,1,2,3,7)]
ref_sizes <-read.delim(refSizes, header=FALSE) #to be consistent with naming in EH
tar_sizes <-read.delim(tarSizes, header=FALSE)
colnames(data) = c("tarchr", "tarstart", "tarend", "refchr", "refstart", "refend", "dir")
colnames(ref_sizes) = c("refchr", "size")
colnames(tar_sizes) = c("tarchr", "size")
#This adds gap in between reference chromosomes and convert to "linear" genome
for (i in c(1:nrow(ref_sizes))){
#print(i)
if (i == 1){
total_start = 1
total_end = ref_sizes[i, "size"]
} else {
total_start = total_end + 6000000
total_end = total_start + ref_sizes[i, "size"]
}
ref_sizes[i,"xstart"] = total_start
ref_sizes[i, "xend"] = total_end
}
#This adds gap in between target chromosomes
for (i in c(1:nrow(tar_sizes))){
#print(i)
if (i == 1){
total_start = 1
total_end = tar_sizes[i, "size"]
} else {
total_start = total_end + 6000000
total_end = total_start + tar_sizes[i, "size"]
}
tar_sizes[i,"xstart"] = total_start
tar_sizes[i, "xend"] = total_end
}
#This converts coordinates to linear genome and creates synteny polygon coordinates
synteny = data.frame()
for (i in c(1:nrow(data))){
tar_chr = data[i,"tarchr"]
ref_chr = data[i,"refchr"]
dir = data[i, "dir"]
tar_add = tar_sizes[as.character(tar_sizes$tarchr)==as.character(tar_chr),]$xstart
ref_add = ref_sizes[as.character(ref_sizes$refchr)==as.character(ref_chr),]$xstart
tar_y = 0.1
ref_y = 2
tar_xstart = data[i,"tarstart"] + tar_add
tar_xend = data[i,"tarend"] + tar_add
ref_xstart = data[i,"refstart"] + ref_add
ref_xend = data[i,"refend"] + ref_add
inverted = grepl("-", dir, fixed = TRUE)
if(inverted == TRUE){
df = data.frame(x = c(tar_xstart, tar_xend, ref_xstart, ref_xend), y = c(tar_y, tar_y, ref_y, ref_y),
fill = ref_chr, group = paste0("s",i))
} else {
df = data.frame(x = c(tar_xstart, ref_xstart, ref_xend,  tar_xend), y = c(tar_y, ref_y, ref_y, tar_y),
fill = ref_chr, group = paste0("s",i))
}
synteny = rbind(synteny,df)
}
#making sure chr columns are factors
tar_sizes$tarchr<-as.factor(tar_sizes$tarchr)
ref_sizes$refchr<-as.factor(ref_sizes$refchr)
synteny$fill<-as.factor(synteny$fill)
#pdf(paste0("test1",".pdf"),width=20, height =5, pointsize = 10)
#This prints plot
ggplot2::ggplot(size = 0.2, font = 10, data = data) +
ggplot2::geom_rect(data=ref_sizes, mapping=ggplot2::aes(xmin=xstart, xmax=xend, ymin=2, ymax=2.10, fill=refchr),
color="black", alpha = 0.85, size = 0.2 ) +
ggplot2::geom_text(data=ref_sizes,ggplot2::aes(x=(xstart+xend)/2,y=2.15,label=refchr),size=2,angle=45) +
ggplot2::geom_text(mapping=ggplot2::aes(x=2,y=2.3, label=refName),size=3,hjust = 1) +
ggplot2::geom_rect(data=tar_sizes, mapping=ggplot2::aes(xmin=xstart, xmax=xend, ymin=0, ymax=0.10),fill="grey85",
color="black", alpha = 0.85, size = 0.2 ) +
ggplot2::geom_text(data=tar_sizes,ggplot2::aes(x=(xstart+xend)/2,y=-0.05,label=tarchr),size=2,angle=45) +
ggplot2::geom_text(mapping=ggplot2::aes(x=2,y=-0.20, label=tarName),size=3,hjust = 1) +
ggplot2::geom_polygon(data = synteny, alpha = .5, ggplot2::aes(x = x, y = y, group = group, fill = fill)) +
ggplot2::scale_fill_manual(values = c("1" = "#BFD73B", "2" = "#39ACE2", "3" = "#F16E8A",
"4" = "#2DB995", "5" = "#855823", "6" = "#A085BD",
"7" = "#2EB560", "8" = "#D79128", "9" = "#FDBB63",
"10" = "#AFDFE5", "11" = "#BF1E2D", "12" = "purple4",
"13"= "#B59F31", "14" = "#F68B1F", "15" = "#EF374B",
"16" = "#D376FF", "17" = "#009445", "18" = "#CE4699",
"19" = "#7C9ACD", "20" = "#84C441", "21" = "#404F23",
"22" = "#607F4B", "23" = "#EBB4A9", "24" = "#F6EB83",
"25" = "#915F6D", "26" = "#602F92", "27" = "#81CEC6",
"28" = "#F8DA04", "29" = "peachpuff2", "30" = "gray85", "33" = "peachpuff3",
"W" = "#9590FF", "Z" = "#666666", "Y" = "#9590FF", "X" = "#666666",
"LGE22" = "grey", "LGE64" = "gray64",
"1A" = "pink", "1B" = "dark blue", "4A" = "light green",
"Gap" = "white", "LG2" = "black", "LG5" = "#CC99CC")) +
ggplot2::theme(panel.background = ggplot2::element_blank(),
strip.background = ggplot2::element_blank(),
axis.title.y = ggplot2::element_blank(),
axis.title.x = ggplot2::element_blank(),
axis.text.x = ggplot2::element_blank(),
axis.text.y = ggplot2::element_blank(),
axis.ticks.x=ggplot2::element_blank(),
axis.ticks.y=ggplot2::element_blank(),
legend.position="none")
#dev.off()
ggsave(paste0(output,".pdf"),width=20, height =5, pointsize = 10)
}
draw.pairwise("testEre.bed","testingAnc","APCF_sizes.txt","Eresizes.txt","Anc","ere")
draw.pairwise("testEre.bed","testingAnc","APCF_sizes.txt","Eresizes.txt","Species 1","Species 2")
quit()
quit()
